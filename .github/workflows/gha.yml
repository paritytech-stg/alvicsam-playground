name: self-hosted-runner-default
on:
  push:
  merge_group:

concurrency:
  group: ${{ github.workflow }}-${{ github.event.pull_request.number || github.ref }}
  cancel-in-progress: true

env:
  RUST_NIGHTLY_VERSION: 2024-03-14 # 1.78.0-nightly

jobs:
  hello-world:
    # runs-on: arc-runners-default
    runs-on: ubuntu-latest
    # container:
    #   image: ${{ vars.CI_UNIFIED_IMAGE }}
    # image: europe-docker.pkg.dev/parity-ci-2024/ci-images/ci-unified:bullseye-1.75.0
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: hello
        run: |
          echo "installing rustup stable"
          rustup install 1.75.0
          rustup default 1.75.0
          echo "installing wasm32-unknown-unknown"
          rustup target add wasm32-unknown-unknown
          echo "installing rustup nightly"
          rustup toolchain install "nightly-${{ env.RUST_NIGHTLY_VERSION }}" --profile minimal --component rustfmt rust-analyzer
          echo "installing wasm32-unknown-unknown for nightly"
          rustup target add wasm32-unknown-unknown --toolchain "nightly-${{ env.RUST_NIGHTLY_VERSION }}
          echo "showing rustup info"
          rustup show
          cargo +nightly-${{ env.RUST_NIGHTLY_VERSION }} fmt --all -- --check

  # hello-world2:
  #   runs-on: arc-runners-default
  #   container:
  #     image: ${{ vars.CI_UNIFIED_IMAGE }}
  #   steps:
  #     - name: fail me
  #       run: |
  #         exit 1
  # hello-world3:
  #   runs-on: arc-runners-default
  #   strategy:
  #     fail-fast: false
  #     matrix:
  #       network: [rococo, westend]
  #   steps:
  #     - name: run ${{ matrix.package }}
  #       run: |
  #         echo "Running ${{ matrix.network }}"
  #         env
  #         # sleep 100
  # hello-world4:
  #   runs-on: arc-runners-default
  #   container:
  #     image: "paritytech/ci-unified:bullseye-1.74.0-2023-11-01-v20231204"
  #   steps:
  #     - name: run ${{ matrix.package }}
  #       run: |
  #         echo "Running ${{ matrix.network }}"
  #         env
  #         # sleep 100
